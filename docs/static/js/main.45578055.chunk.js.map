{"version":3,"sources":["Frame.jsx","App.jsx","index.jsx"],"names":["Frame","animate","_this","renderScene","frameId","window","requestAnimationFrame","_this2","this","script","document","createElement","src","async","onload","Ammo","then","lib","loadThree","body","appendChild","_this3","width","mount","clientWidth","height","clientHeight","modelUrl","concat","props","model","motionUrls","motions","map","m","clock","THREE","camera","position","z","scene","background","gridHelper","y","add","ambient","directionalLight","set","normalize","renderer","antialias","setClearColor","setSize","domElement","helper","MMDAnimationHelper","afterglow","loader","MMDLoader","loadWithAnimation","mesh","x","modelX","modelY","modelZ","animation","physics","ikHelper","objects","get","ikSolver","createHelper","visible","physicsHelper","start","stop","removeChild","cancelAnimationFrame","update","getDelta","render","_this4","react_default","a","style","padding","margin","ref","React","Component","App","src_Frame","params","URLSearchParams","location","search","ReactDOM","src_App","getElementById"],"mappings":"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","file":"static/js/main.45578055.chunk.js","sourcesContent":["import React from 'react';\nimport * as THREE from 'three';\nimport { MMDLoader } from 'three/examples/jsm/loaders/MMDLoader';\nimport { MMDAnimationHelper } from 'three/examples/jsm/animation/MMDAnimationHelper';\n\nclass Frame extends React.Component {\n  componentDidMount() {\n    const script = document.createElement('script');\n    script.src = 'js/ammo.js';\n    script.async = true;\n    script.onload = () => {\n      window.Ammo().then(lib => {\n        window.Ammo = lib;\n        this.loadThree();\n        this.animate();\n      });\n    };\n    document.body.appendChild(script);\n  }\n\n  loadThree() {\n    const width = this.mount.clientWidth;\n    const height = this.mount.clientHeight;\n    this.modelUrl = `pmx/${this.props.model}/model.pmx`;\n    this.motionUrls = this.props.motions.map(m => `vmd/${m}.vmd`);\n\n    // Camera\n    this.clock = new THREE.Clock();\n    this.camera = new THREE.PerspectiveCamera(45, width/height, 1, 2000);\n    this.camera.position.z = 30;\n\n    // Scene\n    this.scene = new THREE.Scene();\n    this.scene.background = new THREE.Color(0xffffff);\n\n    this.gridHelper = new THREE.PolarGridHelper(30, 10);\n    this.gridHelper.position.y = -10;\n    this.scene.add(this.gridHelper);\n\n    this.ambient = new THREE.AmbientLight(0x666666);\n    this.scene.add(this.ambient);\n\n    this.directionalLight = new THREE.DirectionalLight(0x887766);\n    this.directionalLight.position.set(-1, 1, 1).normalize();\n    this.scene.add(this.directionalLight);\n\n    // Renderer\n    this.renderer = new THREE.WebGLRenderer({antialias: true});\n    this.renderer.setClearColor('#000000');\n    this.renderer.setSize(width, height);\n    this.mount.appendChild(this.renderer.domElement);\n\n    // Model\n    this.helper = new MMDAnimationHelper({afterglow: 2.0});\n    this.loader = new MMDLoader();\n    this.loader.loadWithAnimation(this.modelUrl, this.motionUrls, model => {\n      this.mesh = model.mesh;\n      this.mesh.position.x = this.props.modelX || 0;\n      this.mesh.position.y = this.props.modelY || -10;\n      this.mesh.position.z = this.props.modelZ || 0;\n      this.scene.add(this.mesh);\n      this.helper.add(this.mesh, {animation: model.animation, physics: true});\n\n      this.ikHelper = this.helper.objects.get(this.mesh).ikSolver.createHelper();\n      this.ikHelper.visible = false;\n      this.scene.add(this.ikHelper);\n\n      this.physicsHelper = this.helper.objects.get(this.mesh).physics.createHelper();\n      this.physicsHelper.visible = false;\n      this.scene.add(this.physicsHelper);\n\n      this.start();\n    }, () => null, null);\n  }\n\n  componentWillUnmount() {\n    this.stop();\n    this.mount.removeChild(this.renderer.domElement);\n  }\n\n  start() {\n    if (!this.frameId) {\n      this.frameId = requestAnimationFrame(this.animate);\n    }\n  }\n\n  stop() {\n    cancelAnimationFrame(this.frameId);\n  }\n\n  animate = () => {\n    this.renderScene();\n    this.frameId = window.requestAnimationFrame(this.animate);\n  }\n\n  renderScene() {\n    this.helper.update(this.clock.getDelta());\n    this.renderer.render(this.scene, this.camera);\n  }\n\n  render() {\n    return(<div\n      style={{width: '800px', height: '600px', padding: '0', margin: 'auto'}}\n      ref={mount => {this.mount = mount;}}\n    />);\n  }\n}\n\nexport default Frame;\n","import React from 'react';\nimport Frame from './Frame';\n\nclass App extends React.Component {\n  render() {\n    if (this.props.model === 'liliya') return <Frame\n      model={'liliya'}\n      motions={['wavefile']}\n    />;\n    if (this.props.model === 'seele') return <Frame\n      model={'seele'}\n      motions={['senbonzakura']}\n    />;\n    return <Frame\n      model={'wendy'}\n      motions={['sweetmagic-lip', 'sweetmagic-left']}\n      modelX={10}\n    />;\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nimport './index.css';\n\nconst params = new URLSearchParams(window.location.search);\nReactDOM.render(<App model={params.get('model')}/>, document.getElementById('root'));\n"],"sourceRoot":""}