{"version":3,"sources":["Frame.jsx","App.jsx","index.jsx"],"names":["Frame","animate","_this","renderScene","frameId","window","requestAnimationFrame","_this2","this","script","document","createElement","src","async","onload","Ammo","then","lib","loadThree","body","appendChild","materials","array","i","length","m","THREE","copy","needsUpdate","push","_this3","width","mount","clientWidth","height","clientHeight","modelUrl","concat","props","model","motionUrls","motions","map","clock","camera","position","z","scene","background","gridHelper","y","add","ambient","directionalLight","set","normalize","renderer","antialias","setClearColor","setSize","domElement","controls","OrbitControls","helper","MMDAnimationHelper","afterglow","loader","MMDLoader","loadWithAnimation","mesh","x","modelX","modelY","modelZ","material","makePhongMaterials","animation","physics","ikHelper","objects","get","ikSolver","createHelper","visible","physicsHelper","start","stop","removeChild","cancelAnimationFrame","update","getDelta","render","_this4","react_default","a","style","padding","margin","ref","React","Component","App","src_Frame","params","URLSearchParams","location","search","ReactDOM","src_App","getElementById"],"mappings":"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","file":"static/js/main.864bc4c9.chunk.js","sourcesContent":["import React from 'react';\nimport * as THREE from 'three';\nimport { MMDLoader } from 'three/examples/jsm/loaders/MMDLoader';\nimport { MMDAnimationHelper } from 'three/examples/jsm/animation/MMDAnimationHelper';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';\n\nclass Frame extends React.Component {\n  componentDidMount() {\n    const script = document.createElement('script');\n    script.src = 'js/ammo.js';\n    script.async = true;\n    script.onload = () => {\n      window.Ammo().then(lib => {\n        window.Ammo = lib;\n        this.loadThree();\n        this.animate();\n      });\n    };\n    document.body.appendChild(script);\n  }\n\n  makePhongMaterials(materials) {\n    let array = [];\n    for (let i = 0; i < materials.length; i++) {\n      let m = new THREE.MeshPhongMaterial();\n      m.copy(materials[i]);\n      m.needsUpdate = true;\n      array.push(m);\n    }\n    return array;\n  }\n\n  loadThree() {\n    const width = this.mount.clientWidth;\n    const height = this.mount.clientHeight;\n    this.modelUrl = `pmx/${this.props.model}/model.pmx`;\n    this.motionUrls = this.props.motions.map(m => `vmd/${m}.vmd`);\n\n    // Camera\n    this.clock = new THREE.Clock();\n    this.camera = new THREE.PerspectiveCamera(45, width/height, 1, 2000);\n    this.camera.position.z = 30;\n\n    // Scene\n    this.scene = new THREE.Scene();\n    this.scene.background = new THREE.Color(0xd1cdb7);\n\n    this.gridHelper = new THREE.PolarGridHelper(30, 10);\n    this.gridHelper.position.y = -10;\n    this.scene.add(this.gridHelper);\n\n    this.ambient = new THREE.AmbientLight(0x666666);\n    this.scene.add(this.ambient);\n\n    this.directionalLight = new THREE.DirectionalLight(0x887766);\n    this.directionalLight.position.set(-1, 1, 1).normalize();\n    this.scene.add(this.directionalLight);\n\n    // Renderer\n    this.renderer = new THREE.WebGLRenderer({antialias: true});\n    this.renderer.setClearColor('#000000');\n    this.renderer.setSize(width, height);\n    this.mount.appendChild(this.renderer.domElement);\n    this.controls = new OrbitControls(this.camera, this.renderer.domElement);\n\n    // Model\n    this.helper = new MMDAnimationHelper({afterglow: 2.0});\n    this.loader = new MMDLoader();\n    this.loader.loadWithAnimation(this.modelUrl, this.motionUrls, model => {\n      this.mesh = model.mesh;\n      this.mesh.position.x = this.props.modelX || 0;\n      this.mesh.position.y = this.props.modelY || -10;\n      this.mesh.position.z = this.props.modelZ || 0;\n      this.mesh.material = this.makePhongMaterials(this.mesh.material);\n      this.scene.add(this.mesh);\n      this.helper.add(this.mesh, {animation: model.animation, physics: true});\n\n      this.ikHelper = this.helper.objects.get(this.mesh).ikSolver.createHelper();\n      this.ikHelper.visible = false;\n      this.scene.add(this.ikHelper);\n\n      this.physicsHelper = this.helper.objects.get(this.mesh).physics.createHelper();\n      this.physicsHelper.visible = false;\n      this.scene.add(this.physicsHelper);\n\n      this.start();\n    }, () => null, null);\n  }\n\n  componentWillUnmount() {\n    this.stop();\n    this.mount.removeChild(this.renderer.domElement);\n  }\n\n  start() {\n    if (!this.frameId) {\n      this.frameId = requestAnimationFrame(this.animate);\n    }\n  }\n\n  stop() {\n    cancelAnimationFrame(this.frameId);\n  }\n\n  animate = () => {\n    this.renderScene();\n    this.frameId = window.requestAnimationFrame(this.animate);\n  }\n\n  renderScene() {\n    this.helper.update(this.clock.getDelta());\n    this.renderer.render(this.scene, this.camera);\n  }\n\n  render() {\n    return(<div\n      style={{width: '800px', height: '600px', padding: '0', margin: 'auto'}}\n      ref={mount => {this.mount = mount;}}\n    />);\n  }\n}\n\nexport default Frame;\n","import React from 'react';\nimport Frame from './Frame';\n\nclass App extends React.Component {\n  render() {\n    if (this.props.model === 'liliya') return <Frame\n      model={'liliya'}\n      motions={['wavefile']}\n    />;\n    if (this.props.model === 'seele') return <Frame\n      model={'seele'}\n      motions={['senbonzakura']}\n    />;\n    return <Frame\n      model={'wendy'}\n      motions={['sweetmagic-lip', 'sweetmagic-left']}\n      modelX={10}\n    />;\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nimport './index.css';\nimport './yorha.css';\n\nconst params = new URLSearchParams(window.location.search);\nReactDOM.render(<App model={params.get('model')}/>, document.getElementById('root'));\n"],"sourceRoot":""}